<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>구글 스프레드시트 데이터</title>
  <style>
    .data-list {
      list-style-type: none;
      padding: 0;
    }
    .data-list li {
      margin-bottom: 10px;
    }
    .author {
      color: blue;
      font-weight: bold;
    }
    img {
      max-width: 100%;
      height: auto;
    }
  </style>
</head>
<body>
  <h1>구글 스프레드시트 데이터</h1>
  <p id="data">불러오는 중...</p>

  <ul class="data-list" id="data-list"></ul>

  <script>
    fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vS51SDANoy5EhKuTDgyn_Z_9KTC-_0X8V_H5dGi7bWpmuuSZF2yDbw517p_EDKMD5Ic3iK5TjNC19Al/pub?output=csv')
      .then(response => response.text())
      .then(data => {
        // CSV 데이터를 행 단위로 나누기
        const rows = data.split('\n');

        // 불러온 데이터 확인 (헤더와 첫 번째 데이터부터 시작)
        let list = document.getElementById('data-list');
        
        // "불러오는 중..." 텍스트 제거
        document.getElementById('data').style.display = 'none';

        // 데이터를 1부터 시작 (헤더는 제외하고)
        for (let i = 1; i < rows.length - 1; i++) {
          const columns = rows[i].split(',');

          // D열 값 (작성자)
          const dValue = columns[3];  // D열은 4번째 열
          // H열 값 (글자)
          const hValue = columns[7];  // H열은 8번째 열
          // I열 값 (이미지 URL)
          const iValue = columns[8];  // I열은 9번째 열
          
          // D열 (작성자) 리스트 항목 생성
          const listItemD = document.createElement('li');
          listItemD.classList.add('author');
          listItemD.innerText = `작성자: ${dValue}`;
          list.appendChild(listItemD);

          // H열 (글자) 리스트 항목 생성
          const listItemH = document.createElement('li');
          listItemH.innerText = `글자: ${hValue}`;
          list.appendChild(listItemH);

          // I열 (이미지) 리스트 항목 생성 (이미지가 있을 경우만 표시)
          if (iValue) {
            const listItemI = document.createElement('li');
            const imgElement = document.createElement('img');
            imgElement.src = decodeURIComponent(iValue); // URL에서 특수문자 해석
            imgElement.alt = '관련 이미지';
            
            listItemI.appendChild(imgElement);
            list.appendChild(listItemI);
          }
        }
      })
      .catch(error => console.error('Error fetching data: ', error));
  </script>
</body>
</html>
